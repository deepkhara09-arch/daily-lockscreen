<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wallpaper</title>

<style>
@font-face{
  font-family:"FuturaCustom";
  src:url("/assets/futura.ttf");
}

body{
  margin:0;
  background:black;
}

img{
  width:100vw;
  height:100vh;
  object-fit:cover;
}
</style>
</head>

<body>

<canvas id="c"></canvas>

<script>

// ----------------------
// CONFIG
// ----------------------

const tasks = ["Workout","Study","Reading","Test","Mock Interview"];
const colors = ["#FFD84D","#FF3B30","#FF9F0A","#32D2F0","#2BD67B"];
const state = JSON.parse(localStorage.getItem("state")) || {};

// iPhone 13 Pro resolution
const canvas = document.getElementById("c");
canvas.width = 1170;
canvas.height = 2532;
const ctx = canvas.getContext("2d");

// ----------------------
// BACKGROUND
// ----------------------

ctx.fillStyle = "black";
ctx.fillRect(0,0,canvas.width,canvas.height);

// Space for clock
let y = 520;

// ----------------------
// LOAD IMAGES
// ----------------------

function load(src){
  return new Promise(res=>{
    const img = new Image();
    img.src = src;
    img.onload = () => res(img);
  });
}

Promise.all([
  load("/assets/check.png"),
  load("/assets/dino.png")
]).then(([check,dino])=>{

  let done = 0;

  tasks.forEach((task,i)=>{

    if(state[task]) done++;

    // ---- PERFECT CIRCLE ----
    const cx = 200;
    const cy = y + 80;
    const r = 80;

    ctx.beginPath();
    ctx.arc(cx, cy, r, 0, Math.PI * 2);
    ctx.fillStyle = colors[i];
    ctx.fill();

    // ---- CHECKMARK CENTERED ----
    if(state[task]){
      const size = 90;
      ctx.drawImage(
        check,
        cx - size/2,
        cy - size/2,
        size,
        size
      );
    }

    // ---- TEXT ----
    ctx.fillStyle="white";
    ctx.font="900 100px FuturaCustom, Arial";
    ctx.textAlign="left";
    ctx.fillText(task,360,y+110);

    y += 220;
  });

  // ---- PROGRESS ----
  ctx.textAlign="center";
  ctx.fillStyle="white";
  ctx.font="900 70px FuturaCustom, Arial";
  ctx.fillText(`${done}/5 Completed`,canvas.width/2,y+120);

  // ---- DINO ----
  ctx.drawImage(
    dino,
    canvas.width/2-260,
    canvas.height-520,
    520,
    380
  );

  // ---- OUTPUT IMAGE ----
  const img=document.createElement("img");
  img.src = canvas.toDataURL("image/png");
  document.body.innerHTML="";
  document.body.appendChild(img);

});

</script>

</body>
</html>
