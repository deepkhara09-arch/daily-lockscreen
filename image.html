<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wallpaper</title>

<style>
@font-face{
  font-family:"FuturaCustom";
  src:url("/assets/futura.ttf");
}

body{
  margin:0;
  background:black;
}

img{
  width:100vw;
  height:100vh;
  object-fit:cover;
}
</style>
</head>

<body>

<canvas id="c"></canvas>

<script>

// ----------------------
// CONFIG
// ----------------------

const tasks = ["Workout","Study","Reading","Test","Mock Interview"];
const state = JSON.parse(localStorage.getItem("state")) || {};

// iPhone 13 Pro resolution
const canvas = document.getElementById("c");
canvas.width = 1170;
canvas.height = 2532;
const ctx = canvas.getContext("2d");

// ----------------------
// BACKGROUND
// ----------------------

ctx.fillStyle = "black";
ctx.fillRect(0,0,canvas.width,canvas.height);

// Space for iOS clock
let y = 520;

// ----------------------
// IMAGE LOADER
// ----------------------

function load(src){
  return new Promise(res=>{
    const img = new Image();
    img.src = src;
    img.onload = () => res(img);
  });
}

Promise.all([
  load("/assets/check.png"),
  load("/assets/dino.png"),
  load("/assets/yellow.png"),
  load("/assets/red.png"),
  load("/assets/orange.png"),
  load("/assets/blue.png"),
  load("/assets/green.png")
]).then(([check,dino,yel,red,org,blu,grn])=>{

  const circles=[yel,red,org,blu,grn];
  let done=0;

  tasks.forEach((task,i)=>{

    if(state[task]) done++;

    // ---- Circle ----
    const circleX = 120;
    const circleSize = 160;
    ctx.drawImage(circles[i],circleX,y,circleSize,circleSize);

    // ---- Checkmark (perfect center) ----
    if(state[task]){
      const checkSize = 92;
      const checkX = circleX + (circleSize-checkSize)/2;
      const checkY = y + (circleSize-checkSize)/2;
      ctx.drawImage(check,checkX,checkY,checkSize,checkSize);
    }

    // ---- Text ----
    ctx.fillStyle="white";
    ctx.font="900 100px FuturaCustom, Arial";
    ctx.textAlign="left";
    ctx.fillText(task,320,y+115);

    y += 220;
  });

  // ---- Progress ----
  ctx.textAlign="center";
  ctx.fillStyle="white";
  ctx.font="900 70px FuturaCustom, Arial";
  ctx.fillText(`${done}/5 Completed`,canvas.width/2,y+120);

  // ---- Dino ----
  ctx.drawImage(
    dino,
    canvas.width/2-260,
    canvas.height-520,
    520,
    380
  );

  // ---- Output ----
  const img=document.createElement("img");
  img.src = canvas.toDataURL("image/png");
  document.body.innerHTML="";
  document.body.appendChild(img);

});

</script>

</body>
</html>
