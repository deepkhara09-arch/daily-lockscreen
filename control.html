<!DOCTYPE html>
<html>
<head>
<title>Daily Checklist</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>

html, body{
  height:100%;
}

body{
  margin:0;
  background:#0d0d0d;
  color:white;
  font-family:-apple-system, BlinkMacSystemFont, sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
}

.app{
  width:100%;
  max-width:420px;
  padding:30px 22px;
  box-sizing:border-box;
  text-align:center;
}

h1{
  font-size:30px;
  margin-bottom:35px;
}

button{
  width:100%;
  padding:26px;
  margin:14px 0;
  font-size:22px;
  border-radius:22px;
  border:none;
  font-weight:600;
  background:#1f1f1f;
  color:white;
  transition:transform 0.08s ease, background 0.2s;
}

button:active{
  transform:scale(0.96);
}

.done{
  background:#00e676;
  color:black;
}

.notdone{
  background:#1f1f1f;
}

</style>

</head>

<body>

<div class="app">

<h1>Daily Checklist</h1>

<button id="workout" onclick="toggleTask('workout')">Workout</button>
<button id="study" onclick="toggleTask('study')">Study</button>
<button id="reading" onclick="toggleTask('reading')">Reading</button>
<button id="test" onclick="toggleTask('test')">Test</button>
<button id="mock" onclick="toggleTask('mock')">Mock Interview</button>

</div>

<script>

const SUPABASE_URL = "https://vgirktwcmamfjnjbqndn.supabase.co"
const ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZnaXJrdHdjbWFtZmpuamJxbmRuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAwMzU0OTYsImV4cCI6MjA4NTYxMTQ5Nn0.StAPWo-nEvMnUwet8-f8BXmQZdSFn-UGVGwDHFNvlLM"

const TASKS = ["workout","study","reading","test","mock"]

async function getState(){
  const r = await fetch(
    SUPABASE_URL + "/rest/v1/state?id=eq.1",
    {
      headers:{
        apikey: ANON_KEY,
        Authorization: "Bearer " + ANON_KEY
      }
    }
  )
  const d = await r.json()
  return d[0]
}

async function render(){
  const s = await getState()
  TASKS.forEach(t=>{
    document.getElementById(t).className =
      s[t] ? "done" : "notdone"
  })
}

async function toggleTask(task){
  const s = await getState()
  s[task] = !s[task]

  await fetch(
    SUPABASE_URL + "/rest/v1/state?id=eq.1",
    {
      method:"PATCH",
      headers:{
        apikey: ANON_KEY,
        Authorization: "Bearer " + ANON_KEY,
        "Content-Type":"application/json"
      },
      body: JSON.stringify({
        [task]: s[task]
      })
    }
  )

  render()
}

render()

</script>

</body>
</html>
