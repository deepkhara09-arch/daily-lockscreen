<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Daily Checklist</title>

<style>
body{
  margin:0;
  min-height:100vh;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:linear-gradient(180deg,#050505,#111);
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
}

.container{
  width:100%;
  max-width:420px;
  padding:24px;
}

h1{
  text-align:center;
  margin-bottom:30px;
  font-size:28px;
  letter-spacing:1px;
}

button{
  width:100%;
  padding:22px;
  margin:14px 0;
  font-size:20px;
  border-radius:18px;
  border:none;
  background:#222;
  color:white;
  transition:all .15s ease;
}

button:active{
  transform:scale(0.97);
}

.done{
  background:#00e676;
  color:black;
  box-shadow:0 0 20px rgba(0,230,118,.5);
}
</style>
</head>

<body>

<div class="container">
<h1>Daily Checklist</h1>

<button id="workout" onclick="toggleTask('workout')">Workout</button>
<button id="study" onclick="toggleTask('study')">Study</button>
<button id="reading" onclick="toggleTask('reading')">Reading</button>
<button id="test" onclick="toggleTask('test')">Test</button>
<button id="mock" onclick="toggleTask('mock')">Mock Interview</button>
</div>

<!-- Confetti Library -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
const API =
"https://vgirktwcmamfjnjbqndn.supabase.co/rest/v1/state?id=eq.1"

const API_KEY =
"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZnaXJrdHdjbWFtZmpuamJxbmRuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAwMzU0OTYsImV4cCI6MjA4NTYxMTQ5Nn0.StAPWo-nEvMnUwet8-f8BXmQZdSFn-UGVGwDHFNvlLM"

let state = {
  workout:false,
  study:false,
  reading:false,
  test:false,
  mock:false
}

// Load current state
fetch(API,{
  headers:{
    apikey:API_KEY,
    Authorization:"Bearer "+API_KEY
  }
})
.then(r=>r.json())
.then(data=>{
  state = data[0]
  render()
})

function render(){
  for(const t in state){
    const btn=document.getElementById(t)
    if(state[t]) btn.classList.add("done")
    else btn.classList.remove("done")
  }
}

// Instant UI + backend sync
function toggleTask(task){

  // Toggle locally first (instant feel)
  state[task]=!state[task]
  render()

  // Confetti if turned ON
  if(state[task]){
    confetti({
      particleCount:120,
      spread:70,
      origin:{y:0.2}
    })
  }

  // Send to backend quietly
  fetch(API,{
    method:"PATCH",
    headers:{
      apikey:API_KEY,
      Authorization:"Bearer "+API_KEY,
      "Content-Type":"application/json"
    },
    body:JSON.stringify({[task]:state[task]})
  })
}
</script>

</body>
</html>
